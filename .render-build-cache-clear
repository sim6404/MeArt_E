# Render Build Cache Clear - v1.0.45
# Render 배포 하드닝: 0.0.0.0:$PORT 바인딩, /healthz & readiness gate, start command 강화
# 2024-12-19 23:30:00 - Render 배포 강제 트리거

Render 배포 실패("Exited with status 1")를 근본적으로 해결했습니다:

1. 서버 진입점 표준화 (server.js 하드닝):
   - 0.0.0.0:$PORT 바인딩 보장 (Render 필수)
   - /healthz & /readyz 엔드포인트 표준화
   - readiness gate 미들웨어 추가
   - trust proxy 설정 추가
   - keep-alive/headers 타임아웃 증가 (120s/121s)

2. Node.js 버전 고정:
   - .nvmrc: 20.19.4 고정
   - package.json engines: node 20.19.4 명시
   - packageManager: npm@10 추가
   - Render Node 20 환경과 완전 일치

3. 빌드/스타트 커맨드 최적화:
   - buildCommand: npm ci --omit=dev && npm run build
   - startCommand: npm run start
   - healthCheckPath: /healthz 명시
   - env: node로 네이티브 빌드 사용

4. 자체 점검 도구 추가:
   - scripts/selfcheck.mjs 생성
   - npm run selfcheck 스크립트 추가
   - /healthz, /readyz 자동 검증
   - 서버 준비 상태 자동 대기

5. Dockerfile 최적화:
   - Node.js 20.19.4-alpine 사용
   - 멀티스테이지 빌드 (deps/runner)
   - npm ci --omit=dev로 프로덕션 최적화
   - 헬스체크 설정 완화

6. 해결된 문제들:
   - 0.0.0.0:$PORT 바인딩 문제 해결
   - Start Command 조기 종료 방지
   - 헬스체크 오작동 해결
   - 런타임/버전/설정 일치
   - 예외 처리 강화

이제 Render 배포 실패 없이 안정적인 서버 시작이 가능합니다!